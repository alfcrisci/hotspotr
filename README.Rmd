[![Build Status](https://travis-ci.org/mpadge/hotspotr.svg?branch=master)](https://travis-ci.org/mpadge/hotspotr)
[![codecov](https://codecov.io/gh/mpadge/hotspotr/branch/master/graph/badge.svg)](https://codecov.io/gh/mpadge/hotspotr)

R package for estimating whether the statistical properties of a spatial pattern
of hotspots may be reproduced with a simple neutral model. Currently only works
for gridded data.

## Install

```{r, eval=FALSE}
devtools::install_github ('mpadge/hotspotr')
```
```{r load, echo=FALSE, message=FALSE}
while (length (grep ('hotspotr', getwd ())) > 0) setwd ("..")
#devtools::document ("hotspotr")
#devtools::check ("hotspotr")
devtools::load_all ("hotspotr")
setwd ("./hotspotr")
```


## Test

First a demonstration with a seed that produces a 2D field very similar to
neutral fields.

```{r demo-moran, fig.width=12, fig.height=6}
plot.new ()
seed <- 18
dat <- ives2d (size=10, seed=seed)
dat <- ives2d (size=10)
rcpp_ac_stats (dat$nbs, dat$z, "moran")
rcpp_ac_stats (dat$nbs, dat$z, "geary")
rcpp_ac_stats (dat$nbs, dat$z, "getis")
test <- test2d (dat$z, dat$nbs, verbose=TRUE, plot=TRUE)
```

The default spatial autocorrelation statistic is Moran's I, with results for
other statistics in this case notably different. Geary's C:
```{r demo-geary, fig.width=12, fig.height=6}
plot.new ()
test <- test2d (dat$z, dat$nbs, plot=TRUE, ac_type='geary')
```

And Getis-Ord:
```{r demo-getis, fig.width=12, fig.height=6}
plot.new ()
test <- test2d (ymat, plot=TRUE, ac_type='getis')
```

Then the text output of `run_tests` for a random seed giving more typically low
p-values.
```{r run_tests}
run_tests (size=10, ntests=100)
```
Note that the model field tested here has a complex *temporal* structure yet a
generic---that is, neutral---*spatial structure, and that the `p-values` reflect
these differences.

`run_tests` can also be used to test a neutral field against a statistial
ensemble of neutral fields:
```{r run_tests_neutral}
run_tests (size=10, ntests=100, neutral=TRUE)
```
